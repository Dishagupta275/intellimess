<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard</title>
</head>
<body>
    <h2>Admin Dashboard</h2>

    <h3>All Bookings</h3>
    <table border="1">
        <tr>
            <th>ID</th>
            <th>User ID</th>
            <th>Meal</th>
            <th>Food Type</th>
            <th>Date</th>
            <th>Time</th>
        </tr>

        {% for b in bookings %}
        <tr>
            <td>{{ b.id }}</td>
            <td>{{ b.user_id }}</td>
            <td>{{ b.meal }}</td>
            <td>{{ b.food_type }}</td>
            <td>{{ b.booking_date }}</td>
            <td>{{ b.booking_time }}</td>
        </tr>
        {% endfor %}
    </table>

    <h3>Feedback Records</h3>
    <table border="1">
        <tr>
            <th>Student</th>
            <th>Dish</th>
            <th>Rating</th>
            <th>Date</th>
        </tr>

        {% for f in feedback %}
        <tr>
            <td>{{ f.username }}</td>
            <td>{{ f.dish_name }}</td>
            <td>{{ f.rating }}</td>
            <td>{{ f.feedback_date }}</td>
        </tr>
        {% endfor %}
    </table>

    <h3>Dish-wise Average Ratings</h3>
    <table border="1">
        <tr>
            <th>Dish</th>
            <th>Average Rating</th>
        </tr>

        {% for d in dish_stats %}
        <tr>
            <td>{{ d.dish_name }}</td>
            <td>{{ "%.2f"|format(d.avg_rating) }}</td>
        </tr>
        {% endfor %}
    </table>

    <h3>Summary</h3>

    <p>
        <strong>Most liked dish:</strong>
        {% if most_liked %}
            {{ most_liked.dish_name }} ({{ "%.2f"|format(most_liked.avg_rating) }})
        {% else %}
            No data
        {% endif %}
    </p>

    <p>
        <strong>Least liked dish:</strong>
        {% if least_liked %}
            {{ least_liked.dish_name }} ({{ "%.2f"|format(least_liked.avg_rating) }})
        {% else %}
            No data
        {% endif %}
    </p>

    <p>
        <strong>Overall satisfaction score:</strong>
        {% if overall.overall %}
            {{ "%.2f"|format(overall.overall) }}
        {% else %}
            No data
        {% endif %}
    </p>

    <br>
    <a href="/logout">Logout</a>
</body>
</html>